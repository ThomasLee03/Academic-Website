{% extends 'FinalProject/base.html' %}

{% block title %}Edit Paper{% endblock %}
{% load custom_filters %}

{% block content %}
<h1 class="mb-4">Edit Paper: {{ paper.title }}</h1>
<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
        <label for="id_title" class="h5">Paper Title</label>
        {{ form.as_p }}
    </div>

    <h3 class="mt-4 mb-3">Images</h3>
    <div class="image-section">
        {% for image in images %}
            <div class="image-item">
                <input type="checkbox" name="images" value="{{ image.id }}" 
                    {% if linked_images and image.id in linked_images %}checked{% endif %}>
                <label>{{ image }}</label><br>
                <img src="{{ image.image_file.url }}" alt="Image {{ image.id }}" class="img-fluid"><br>
            </div>
        {% endfor %}
    </div>

    <h3 class="mt-4 mb-3">Generated Images</h3>
    <div class="image-section">
        {% for gen_image in generated_images %}
            <div class="image-item">
                <input type="checkbox" name="generated_images" value="{{ gen_image.id }}" 
                    {% if linked_generated_images and gen_image.id in linked_generated_images %}checked{% endif %}>
                <img src="{{ gen_image.image_file.url }}" alt="Generated Image {{ gen_image.id }}" class="img-fluid"><br>
            </div>
        {% endfor %}
    </div>

    <h3 class="mt-4 mb-3">Corrupted Images</h3>
    <div class="image-section">
        {% for corr_image in corrupted_images %}
            <div class="image-item">
                <input type="checkbox" name="corrupted_images" value="{{ corr_image.id }}" 
                    {% if linked_corrupted_images and corr_image.id in linked_corrupted_images %}checked{% endif %}>
                <img src="{{ corr_image.corrupted_file.url }}" alt="Corrupted Image {{ corr_image.id }}" class="img-fluid"><br>
            </div>
        {% endfor %}
    </div>

    <h3 class="mt-4 mb-3">Masks</h3>
    <div class="image-section">
        {% for mask in masks %}
            <div class="image-item">
                <input type="checkbox" name="masks" value="{{ mask.id }}" 
                    {% if linked_masks and mask.id in linked_masks %}checked{% endif %}>
                <img src="{{ mask.mask_file.url }}" alt="Mask {{ mask.id }}" class="img-fluid"><br>
            </div>
        {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary mt-4">Save</button>
</form>
{% endblock %}
